<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë°¥ì¤˜ AI - ë©”ë‰´ ì¶”ì²œ ì„œë¹„ìŠ¤</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="container">
        <h1>ğŸ½ï¸ ë°¥ì¤˜ AI ë§ì¶¤ ë©”ë‰´ ì¶”ì²œ</h1>
        <form id="recommendationForm">
            <label for="category">ì›í•˜ëŠ” ë©”ë‰´ ì¹´í…Œê³ ë¦¬:</label>
            <select id="category" name="category" required>
                <option value="" disabled selected>ì„ íƒí•˜ì„¸ìš”</option>
                <option value="í•œì‹">í•œì‹</option>
                <option value="ì¤‘ì‹">ì¤‘ì‹</option>
                <option value="ì¼ì‹">ì¼ì‹</option>
                <option value="ì–‘ì‹">ì–‘ì‹</option>
                <option value="ë¶„ì‹">ë¶„ì‹</option>
                <option value="ê¸°íƒ€">ê¸°íƒ€</option>
            </select>

            <label for="age">ë‹¹ì‹ ì˜ ì—°ë ¹ëŒ€:</label>
            <select id="age" name="age" required>
                <option value="" disabled selected>ì„ íƒí•˜ì„¸ìš”</option>
                <option value="10s">10ëŒ€</option>
                <option value="20s">20ëŒ€</option>
                <option value="30s">30ëŒ€</option>
                <option value="40s">40ëŒ€ ì´ìƒ</option>
            </select>

            <label for="budget">ì˜ˆìƒ ì˜ˆì‚° ë²”ìœ„:</label>
            <select id="budget" name="budget" required>
                <option value="" disabled selected>ì„ íƒí•˜ì„¸ìš”</option>
                <option value="Low">ì €ì˜ˆì‚° (1ë§Œì› ì´í•˜)</option>
                <option value="Mid">ì¤‘ê°„ ì˜ˆì‚° (1ë§Œì› ~ 2ë§Œì›)</option>
                <option value="High">ê³ ì˜ˆì‚° (2ë§Œì› ì´ˆê³¼)</option>
            </select>

            <button type="submit">ë©”ë‰´ ì¶”ì²œë°›ê¸°</button>
        </form>

        <div id="resultContainer" class="result">
        </div>
    </div>

    <script>
        // ============================================================
        // âš ï¸ [ì¤‘ìš”] GitHubì—ì„œ ë”°ì˜¨ Raw ì£¼ì†Œë¥¼ ì•„ë˜ ë”°ì˜´í‘œ ì•ˆì— ë„£ì–´ì£¼ì„¸ìš”!
        // ì˜ˆì‹œ: 'https://raw.githubusercontent.com/eatpeoples/eatpeopls-location/refs/heads/main/menu%20db'
        // ============================================================
        const DB_URL = 'ì—¬ê¸°ì—_GITHUB_RAW_ì£¼ì†Œë¥¼_ë¶™ì—¬ë„£ìœ¼ì„¸ìš”'; 

        const form = document.getElementById('recommendationForm');
        const resultContainer = document.getElementById('resultContainer');

        // ì˜ˆì‚° ë²”ìœ„ë¥¼ ìˆ«ìë¡œ ê³„ì‚°í•´ì£¼ëŠ” íŒë…ê¸° í•¨ìˆ˜
        function checkBudget(price, budgetType) {
            const p = Number(price); // ê°€ê²©ì„ ìˆ«ìë¡œ í™•ì‹¤íˆ ë³€í™˜
            if (budgetType === 'Low') return p <= 10000;
            if (budgetType === 'Mid') return p > 10000 && p <= 20000;
            if (budgetType === 'High') return p > 20000;
            return false;
        }

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            resultContainer.innerHTML = 'âœ¨ ì „ì²´ ë©”ë‰´íŒì„ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...';

            // ì‚¬ìš©ìê°€ ì„ íƒí•œ ê°’ ê°€ì ¸ì˜¤ê¸°
            const selectedCategory = document.getElementById('category').value;
            const selectedAge = document.getElementById('age').value;
            const selectedBudget = document.getElementById('budget').value;

            try {
                // 1. GitHubì—ì„œ ì „ì²´ ë©”ë‰´íŒ ê°€ì ¸ì˜¤ê¸° (ë¹„ìš© 0ì›!)
                const response = await fetch(DB_URL);
                if (!response.ok) {
                    throw new Error("DB íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. URLì„ í™•ì¸í•´ì£¼ì„¸ìš”.");
                }
                const allMenu = await response.json();

                // 2. ë¸Œë¼ìš°ì €ì—ì„œ ì§ì ‘ í•„í„°ë§ (ì •í™•ë„ 100%)
                // ì¡°ê±´: ì¹´í…Œê³ ë¦¬ ì¼ì¹˜ AND ì—°ë ¹ëŒ€ ì¼ì¹˜ AND ê°€ê²©ë²”ìœ„ ì¼ì¹˜
                const filteredMenu = allMenu.filter(item => {
                    return item.Category === selectedCategory && 
                           item.Recommended_Age === selectedAge &&
                           checkBudget(item.Price, selectedBudget);
                });

                // 3. ê²°ê³¼ ì¶œë ¥
                if (filteredMenu.length > 0) {
                    // ì¡°ê±´ì— ë§ëŠ” ë©”ë‰´ ì¤‘ ëœë¤ìœ¼ë¡œ í•˜ë‚˜ ë½‘ê¸°
                    const randomPick = filteredMenu[Math.floor(Math.random() * filteredMenu.length)];
                    
                    // ê°€ê²©ì— ì½¤ë§ˆ ì°ê¸°
                    const formattedPrice = Number(randomPick.Price).toLocaleString();

                    resultContainer.innerHTML = `
                        <h2>âœ… ì¶”ì²œ ë©”ë‰´: <span class="highlight">${randomPick.Menu_Name}</span></h2>
                        <p>ì¹´í…Œê³ ë¦¬: ${randomPick.Category}</p>
                        <p>ê°€ê²©: **${formattedPrice}ì›**</p>
                        <p>ğŸ‘ ì¶”ì²œ ëŒ€ìƒ: **${randomPick.Recommended_Age}**</p>
                        <hr>
                        <p style="font-size:12px; color:gray;">(ì¡°ê±´ì— ë§ëŠ” ë©”ë‰´ ${filteredMenu.length}ê°œ ì¤‘ ëœë¤ ì¶”ì²œ)</p>
                    `;
                } else {
                    // ì§„ì§œ ë°ì´í„°ê°€ ì—†ì„ ë•Œ
                    resultContainer.innerHTML = `
                        <h3>ğŸ¥² ì¡°ê±´ì— ë§ëŠ” ë©”ë‰´ê°€ ì—†ì–´ìš”.</h3>
                        <p>ì¹´í…Œê³ ë¦¬ë‚˜ ì˜ˆì‚°ì„ ì¡°ê¸ˆ ë³€ê²½í•´ì„œ ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”!</p>
                    `;
                }

            } catch (error) {
                console.error('Error:', error);
                resultContainer.innerHTML = 'ğŸš¨ ë°ì´í„° ë¡œë”© ì‹¤íŒ¨! GitHub ì£¼ì†Œë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.';
            }
        });
    </script>
</body>
</html>
